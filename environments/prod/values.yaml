# ============================================================================
# Production Environment Configuration
# Uses version tags (v1.0.0), high resources, multiple replicas
# Production workloads with manual deployment approval
# ============================================================================

global:
  registry: 279987127424.dkr.ecr.us-east-1.amazonaws.com
  imageTag: v1.0.0  # Specific version - NOT latest!

imagePullSecrets:
  - name: ecr-registry-secret

# ECR authentication
ecr:
  enabled: true
  username: AWS
  password: ""  # Set via CD pipeline

# External Secrets Operator configuration
# NOTE: Infra repo must use static names (not name_prefix) for full automation
# See: scoutflow-infra/modules/database-secrets/main.tf
externalSecrets:
  enabled: true
  region: us-east-1
  # Static secret name - matches what terraform creates
  secretName: "scoutflow/prod/database"

# Database configuration
database:
  image:
    repository: scoutflow-app-db
    pullPolicy: IfNotPresent  # Use cached images in production
    tag: ""
  
  replicas: 1
  
  service:
    type: ClusterIP
    port: 5432
  
  persistence:
    storageClass: "standard"
    size: 20Gi  # Larger storage for production
  
  # Only non-sensitive values - password managed by External Secrets Operator
  env:
    POSTGRES_USER: postgres
    POSTGRES_DB: nba_stats


# Ingest job configuration
ingest:
  image:
    repository: scoutflow-app-ingest
    pullPolicy: IfNotPresent
    tag: ""
  
  restartPolicy: Never
  backoffLimit: 3
  
  resources:
    requests:
      cpu: 200m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1Gi

# Backend configuration
backend:
  image:
    repository: scoutflow-app-backend
    pullPolicy: IfNotPresent
    tag: ""
  
  replicas: 3  # High availability
  
  service:
    type: ClusterIP
    port: 8000
  
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 256Mi

# Frontend configuration
frontend:
  image:
    repository: scoutflow-app-frontend
    pullPolicy: IfNotPresent
    tag: ""
  
  replicas: 3  # High availability
  
  service:
    type: ClusterIP
    port: 80
  
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 128Mi

# Ingress configuration
ingress:
  host: scoutflow.example.com